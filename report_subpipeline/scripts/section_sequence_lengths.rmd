#### Assemblies and their contigs:



```{r sequence_lengths, echo=FALSE, message=F, warning=F, error = T, fig.height = max(1.8, N*0.2), fig.width = 10}



sequence_lengths_df = read_tsv(glob_list$sequence_lengths, id = "file_long", comment = "#", col_names = c("name", "length", "GC", "GC-Skew")) %>%
    mutate(sample = basename(file_long) %>% str_remove("_seqlen.tsv"))


metadata_translate %>%
    left_join(sequence_lengths_df, by = "sample") %>%

    group_by(sample) %>% 

    mutate(
        init = lag(length, default = 0),
        start = cumsum(init),
        stop = start + length - 1
    ) %>%
    ungroup() %>%

    ggplot(aes(length, reorder(sample, desc(sample)), fill = GC)) + 
    geom_bar(stat = "identity", color = "black", linewidth = 0.2) + 
    theme_classic() +
    theme(legend.position = "bottom") +
    theme(panel.grid.major.x = element_line(colour = "grey92")) + 
    labs(y = "sample") +
    scale_fill_viridis_c()

        
```

*Fig. `r figno()`: Visualization of the length of each fasta record for each sample. The colors show the mean GC content for each record (contig).*
