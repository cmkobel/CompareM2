



#### Lengths of contigs:

```{r, echo=FALSE, message=F, warning=F}


try({
    # This chunk is needed for setting the size of the forthcoming plot
    knitr::opts_chunk$set(
        fig.height = max(1.6, N*0.2),
        fig.width = 9
    )

})
```

```{r, echo=FALSE, message=F, warning=F}



sequence_lengths_df = read_tsv(glob_list$sequence_lengths, id = "file_long", comment = "#", col_names = c("name", "length", "GC", "GC-Skew")) %>%
    mutate(sample = basename(file_long) %>% str_remove("_seqlen.tsv"))





metadata_translate %>%
    left_join(sequence_lengths_df, by = "sample") %>%

    group_by(sample) %>% 

    mutate(
        init = lag(length, default = 0),
        start = cumsum(init),
        stop = start + length - 1
    ) %>%
    ungroup() %>%

    ggplot(aes(length, reorder(sample, desc(sample)), fill = GC)) + 
    geom_bar(stat = "identity", color = "black", linewidth = 0.2) + 
    theme_classic() +
    theme(legend.position = "bottom") +
    theme(panel.grid.major.x = element_line(colour = "grey92")) + 
    labs(y = "sample") +
    scale_fill_viridis_c()




            
        
        
```

*Fig. `r figno()`: Lengths of fasta records for each sample. The colors have no intrinsic meaning, other than highlighting the varying sizes and number of records in each assembly.*
